!function(e){function t(e,t,n,r){var i,s=0,o=0,u=0,n=(n||"(").toString(),r=(r||")").toString();for(i=0;i<e.length;i++){var a=e[i];if(a.indexOf(n,s)>a.indexOf(r,s)||~a.indexOf(n,s)&&!~a.indexOf(r,s)||!~a.indexOf(n,s)&&~a.indexOf(r,s)){if(o=a.indexOf(n,s),u=a.indexOf(r,s),~o&&!~u||!~o&&~u){var f=e.slice(0,(i||1)+1).join(t);e=[f].concat(e.slice((i||1)+1))}s=(u>o?u:o)+1,i=0}else s=0}return e}function n(e,t){for(var n,i=0,s="";n=e.substr(i).match(/[^\w\d\- %@&]*\*[^\w\d\- %@&]*/);)i=n.index+n[0].length,n[0]=n[0].replace(/^\*/,"([_.()!\\ %@&a-zA-Z0-9-]+)"),s+=e.substr(0,n.index)+n[0];e=s+=e.substr(i);var o,u,a=e.match(/:([^\/]+)/gi);if(a){u=a.length;for(var f=0;u>f;f++)o=a[f],e="::"===o.slice(0,2)?o.slice(1):e.replace(o,r(o,t))}return e}function r(e,t,n){n=e;for(var r in t)if(t.hasOwnProperty(r)&&(n=t[r](e),n!==e))break;return n===e?"([._a-zA-Z0-9-%()]+)":n}function i(e,t,n){if(!e.length)return n();var r=0;!function i(){t(e[r],function(t){t||t===!1?(n(t),n=function(){}):(r+=1,r===e.length?n():i())})}()}function o(e){for(var t=[],n=0,r=e.length;r>n;n++)t=t.concat(e[n]);return t}function u(e,t){for(var n=0;n<e.length;n+=1)if(t(e[n],n,e)===!1)return}function a(){return""===f.hash||"#"===f.hash}var f=document.location,l={mode:"modern",hash:f.hash,history:!1,check:function(){var e=f.hash;e!=this.hash&&(this.hash=e,this.onHashChanged())},fire:function(){"modern"===this.mode?this.history===!0?window.onpopstate():window.onhashchange():this.onHashChanged()},init:function(e,t){function n(e){for(var t=0,n=c.listeners.length;n>t;t++)c.listeners[t](e)}var r=this;if(this.history=t,c.listeners||(c.listeners=[]),"onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7))this.history===!0?setTimeout(function(){window.onpopstate=n},500):window.onhashchange=n,this.mode="modern";else{var i=document.createElement("iframe");i.id="state-frame",i.style.display="none",document.body.appendChild(i),this.writeFrame(""),"onpropertychange"in document&&"attachEvent"in document&&document.attachEvent("onpropertychange",function(){"location"===event.propertyName&&r.check()}),window.setInterval(function(){r.check()},50),this.onHashChanged=n,this.mode="legacy"}return c.listeners.push(e),this.mode},destroy:function(e){if(c&&c.listeners)for(var t=c.listeners,n=t.length-1;n>=0;n--)t[n]===e&&t.splice(n,1)},setHash:function(e){return"legacy"===this.mode&&this.writeFrame(e),this.history===!0?(window.history.pushState({},document.title,e),this.fire()):f.hash="/"===e[0]?e:"/"+e,this},writeFrame:function(e){var t=document.getElementById("state-frame"),n=t.contentDocument||t.contentWindow.document;n.open(),n.write("<script>_hash = '"+e+"'; onload = parent.listener.syncHash;<script>"),n.close()},syncHash:function(){var e=this._hash;return e!=f.hash&&(f.hash=e),this},onHashChanged:function(){}},c=e.Router=function(e){return this instanceof c?(this.params={},this.routes={},this.methods=["on","once","after","before"],this.scope=[],this._methods={},this._insert=this.insert,this.insert=this.insertEx,this.historySupport=null!=(null!=window.history?window.history.pushState:null),this.configure(),this.mount(e||{}),void 0):new c(e)};c.prototype.init=function(e){var t,n=this;return this.handler=function(e){var t=e&&e.newURL||window.location.hash,r=n.history===!0?n.getPath():t.replace(/.*#/,"");n.dispatch("on","/"===r.charAt(0)?r:"/"+r)},l.init(this.handler,this.history),this.history===!1?a()&&e?f.hash=e:a()||n.dispatch("on","/"+f.hash.replace(/^(#\/|#|\/)/,"")):(this.convert_hash_in_init?(t=a()&&e?e:a()?null:f.hash.replace(/^#/,""),t&&window.history.replaceState({},document.title,t)):t=this.getPath(),(t||this.run_in_init===!0)&&this.handler()),this},c.prototype.explode=function(){var e=this.history===!0?this.getPath():f.hash;return"/"===e.charAt(1)&&(e=e.slice(1)),e.slice(1,e.length).split("/")},c.prototype.setRoute=function(e,t,n){var r=this.explode();return"number"==typeof e&&"string"==typeof t?r[e]=t:"string"==typeof n?r.splice(e,t,s):r=[e],l.setHash(r.join("/")),r},c.prototype.insertEx=function(e,t,n,r){return"once"===e&&(e="on",n=function(e){var t=!1;return function(){return t?void 0:(t=!0,e.apply(this,arguments))}}(n)),this._insert(e,t,n,r)},c.prototype.getRoute=function(e){var t=e;if("number"==typeof e)t=this.explode()[e];else if("string"==typeof e){var n=this.explode();t=n.indexOf(e)}else t=this.explode();return t},c.prototype.destroy=function(){return l.destroy(this.handler),this},c.prototype.getPath=function(){var e=window.location.pathname;return"/"!==e.substr(0,1)&&(e="/"+e),e};var h=/\?.*/;c.prototype.configure=function(e){e=e||{};for(var t=0;t<this.methods.length;t++)this._methods[this.methods[t]]=!0;return this.recurse=e.recurse||this.recurse||!1,this.async=e.async||!1,this.delimiter=e.delimiter||"/",this.strict="undefined"==typeof e.strict?!0:e.strict,this.notfound=e.notfound,this.resource=e.resource,this.history=e.html5history&&this.historySupport||!1,this.run_in_init=this.history===!0&&e.run_handler_in_init!==!1,this.convert_hash_in_init=this.history===!0&&e.convert_hash_in_init!==!1,this.every={after:e.after||null,before:e.before||null,on:e.on||null},this},c.prototype.param=function(e,t){":"!==e[0]&&(e=":"+e);var n=new RegExp(e,"g");return this.params[e]=function(e){return e.replace(n,t.source||t)},this},c.prototype.on=c.prototype.route=function(e,n,r){var i=this;return!r&&"function"==typeof n&&(r=n,n=e,e="on"),Array.isArray(n)?n.forEach(function(t){i.on(e,t,r)}):(n.source&&(n=n.source.replace(/\\\//gi,"/")),Array.isArray(e)?e.forEach(function(e){i.on(e.toLowerCase(),n,r)}):(n=n.split(new RegExp(this.delimiter)),n=t(n,this.delimiter),this.insert(e,this.scope.concat(n),r),void 0))},c.prototype.path=function(e,n){var r=this.scope.length;e.source&&(e=e.source.replace(/\\\//gi,"/")),e=e.split(new RegExp(this.delimiter)),e=t(e,this.delimiter),this.scope=this.scope.concat(e),n.call(this,this),this.scope.splice(r,e.length)},c.prototype.dispatch=function(e,t,n){function r(){s.last=o.after,s.invoke(s.runlist(o),s,n)}var i,s=this,o=this.traverse(e,t.replace(h,""),this.routes,""),u=this._invoked;return this._invoked=!0,o&&0!==o.length?("forward"===this.recurse&&(o=o.reverse()),i=this.every&&this.every.after?[this.every.after].concat(this.last):[this.last],i&&i.length>0&&u?(this.async?this.invoke(i,this,r):(this.invoke(i,this),r()),!0):(r(),!0)):(this.last=[],"function"==typeof this.notfound&&this.invoke([this.notfound],{method:e,path:t},n),!1)},c.prototype.invoke=function(e,t,n){var r,s=this;this.async?(r=function(n,s){return Array.isArray(n)?i(n,r,s):void ("function"==typeof n&&n.apply(t,(e.captures||[]).concat(s)))},i(e,r,function(){n&&n.apply(t,arguments)})):(r=function(n){return Array.isArray(n)?u(n,r):"function"==typeof n?n.apply(t,e.captures||[]):void ("string"==typeof n&&s.resource&&s.resource[n].apply(t,e.captures||[]))},u(e,r))},c.prototype.traverse=function(e,t,n,r,i){function s(e){function t(e){for(var n=e.length-1;n>=0;n--)Array.isArray(e[n])?(t(e[n]),0===e[n].length&&e.splice(n,1)):i(e[n])||e.splice(n,1)}function n(e){for(var t=[],r=0;r<e.length;r++)t[r]=Array.isArray(e[r])?n(e[r]):e[r];return t}if(!i)return e;var r=n(e);return r.matched=e.matched,r.captures=e.captures,r.after=e.after.filter(i),t(r),r}var o,u,a,f,l=[];if(t===this.delimiter&&n[e])return f=[[n.before,n[e]].filter(Boolean)],f.after=[n.after].filter(Boolean),f.matched=!0,f.captures=[],s(f);for(var c in n)if(n.hasOwnProperty(c)&&(!this._methods[c]||this._methods[c]&&"object"==typeof n[c]&&!Array.isArray(n[c]))){if(o=u=r+this.delimiter+c,this.strict||(u+="["+this.delimiter+"]?"),a=t.match(new RegExp("^"+u)),!a)continue;if(a[0]&&a[0]==t&&n[c][e])return f=[[n[c].before,n[c][e]].filter(Boolean)],f.after=[n[c].after].filter(Boolean),f.matched=!0,f.captures=a.slice(1),this.recurse&&n===this.routes&&(f.push([n.before,n.on].filter(Boolean)),f.after=f.after.concat([n.after].filter(Boolean))),s(f);if(f=this.traverse(e,t,n[c],o),f.matched)return f.length>0&&(l=l.concat(f)),this.recurse&&(l.push([n[c].before,n[c].on].filter(Boolean)),f.after=f.after.concat([n[c].after].filter(Boolean)),n===this.routes&&(l.push([n.before,n.on].filter(Boolean)),f.after=f.after.concat([n.after].filter(Boolean)))),l.matched=!0,l.captures=f.captures,l.after=f.after,s(l)}return!1},c.prototype.insert=function(e,t,r,i){var s,o,u,a,f;if(t=t.filter(function(e){return e&&e.length>0}),i=i||this.routes,f=t.shift(),/\:|\*/.test(f)&&!/\\d|\\w/.test(f)&&(f=n(f,this.params)),t.length>0)return i[f]=i[f]||{},this.insert(e,t,r,i[f]);if(f||t.length||i!==this.routes){if(o=typeof i[f],u=Array.isArray(i[f]),i[f]&&!u&&"object"==o)switch(s=typeof i[f][e]){case"function":return void (i[f][e]=[i[f][e],r]);case"object":return void i[f][e].push(r);case"undefined":return void (i[f][e]=r)}else if("undefined"==o)return a={},a[e]=r,i[f]=a,void 0;throw new Error("Invalid route context: "+o)}switch(s=typeof i[e]){case"function":return void (i[e]=[i[e],r]);case"object":return void i[e].push(r);case"undefined":return void (i[e]=r)}},c.prototype.extend=function(e){function t(e){r._methods[e]=!0,r[e]=function(){var t=1===arguments.length?[e,""]:[e];r.on.apply(r,t.concat(Array.prototype.slice.call(arguments)))}}var n,r=this,i=e.length;for(n=0;i>n;n++)t(e[n])},c.prototype.runlist=function(e){var t=this.every&&this.every.before?[this.every.before].concat(o(e)):o(e);return this.every&&this.every.on&&t.push(this.every.on),t.captures=e.captures,t.source=e.source,t},c.prototype.mount=function(e,n){function r(n,r){var s=n,o=n.split(i.delimiter),u=typeof e[n],a=""===o[0]||!i._methods[o[0]],f=a?"on":s;a&&(s=s.slice((s.match(new RegExp("^"+i.delimiter))||[""])[0].length),o.shift()),a&&"object"===u&&!Array.isArray(e[n])?(r=r.concat(o),i.mount(e[n],r)):(a&&(r=r.concat(s.split(i.delimiter)),r=t(r,i.delimiter)),i.insert(f,r,e[n]))}if(e&&"object"==typeof e&&!Array.isArray(e)){var i=this;n=n||[],Array.isArray(n)||(n=n.split(i.delimiter));for(var s in e)e.hasOwnProperty(s)&&r(s,n.slice(0))}}}("object"==typeof exports?exports:window);